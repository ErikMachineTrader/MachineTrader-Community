[
    {
        "id": "5221562b819142ed",
        "type": "function",
        "z": "88f16d512ab03323",
        "name": "calculate profit for each algo",
        "func": "let name = msg.name\nlet total_gain_today = msg.payload[\"a\"]\nlet total_gain_alltime = msg.payload[\"b\"]\nlet total_profit = msg.payload[\"c\"]\nlet total_market = msg.payload[\"d\"]\nlet pctgain_today = 0\nlet pctgain_alltime = 0\n\n//node.warn(\"Strategy: \" +name+ \" Total gain today: \" + total_gain_today + \" Total gain alltime: \" + total_gain_alltime + \" Total profit: \" + total_profit + \" Total market value: \" + total_market)\n\nif ( total_market > 0 ) {\n pctgain_today = (total_gain_today / total_market) * 100 }\n\nif (total_market > 0 ) {\n    pctgain_alltime = (total_gain_alltime / total_market) * 100\n}\n\nmsg.query = \"update algos set gain_today = \" +total_gain_today+ \", gain_alltime = \" +total_gain_alltime+ \", pctgain_today = \" + pctgain_today + \", pctgain_alltime = \" + pctgain_alltime + \" where algo_name = '\" + name + \"';\"\n//node.warn(msg.query)\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 940,
        "wires": [
            [
                "632d60577e2210ec"
            ]
        ]
    }
]