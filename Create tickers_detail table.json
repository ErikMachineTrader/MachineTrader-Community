[
    {
        "id": "8c7b432ddeb3c22a",
        "type": "tab",
        "label": "Create tickers_detail table",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "bcb3e5820f27706a",
        "type": "inject",
        "z": "8c7b432ddeb3c22a",
        "name": "GO",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 140,
        "wires": [
            [
                "eee68cf44d60ceaf"
            ]
        ]
    },
    {
        "id": "eee68cf44d60ceaf",
        "type": "function",
        "z": "8c7b432ddeb3c22a",
        "name": "create table ",
        "func": "msg.query = \"create table IF NOT EXISTS tickers_detail (ticker varchar(10) PRIMARY KEY, name varchar(200), market varchar(10), locale varchar(10), primary_exchange varchar(10), type varchar(10),active varchar(10),currency_name varchar(10),cik varchar(100),composite_figi varchar(20), share_class_figi varchar(20), market_cap FLOAT, phone_number varchar(20),address1 varchar(100), description varchar(5000), sic_code varchar(10), sic_description varchar(100), ticker_root varchar(10), homepage_url varchar(200), total_employees int, list_date varchar(20), branding varchar(10), share_class_shares_outstanding bigint, weighted_shares_outstanding bigint, round_lot int, beta float, current_price float, stddev float);\"\n//msg.query = \"truncate table tickers_detail\"\n//msg.query = \"DROP TABLE tickers_detail\"\n\nnode.warn(msg.query)\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 330,
        "y": 140,
        "wires": [
            [
                "9963ef17ff1f602c"
            ]
        ]
    },
    {
        "id": "1e08e3e38aa11b02",
        "type": "debug",
        "z": "8c7b432ddeb3c22a",
        "name": "debug 337",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 140,
        "wires": []
    },
    {
        "id": "9963ef17ff1f602c",
        "type": "postgresql",
        "z": "8c7b432ddeb3c22a",
        "name": "postgres",
        "query": "",
        "postgreSQLConfig": "7455395cf269fb2b",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 480,
        "y": 140,
        "wires": [
            [
                "1e08e3e38aa11b02"
            ]
        ]
    },
    {
        "id": "705de2ddceeae90f",
        "type": "inject",
        "z": "8c7b432ddeb3c22a",
        "name": "",
        "props": [
            {
                "p": "query",
                "v": "select * from tickers_detail",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 80,
        "wires": [
            [
                "89c0100e60f7c69e"
            ]
        ]
    },
    {
        "id": "89c0100e60f7c69e",
        "type": "postgresql",
        "z": "8c7b432ddeb3c22a",
        "name": "postgres",
        "query": "",
        "postgreSQLConfig": "7455395cf269fb2b",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 320,
        "y": 80,
        "wires": [
            [
                "092a94ec99965947"
            ]
        ]
    },
    {
        "id": "8f7636aa3186befc",
        "type": "mysql",
        "z": "8c7b432ddeb3c22a",
        "mydb": "3564bcf07c743fdf",
        "name": "",
        "x": 430,
        "y": 200,
        "wires": [
            [
                "95c7564bd6f21f23"
            ]
        ]
    },
    {
        "id": "6f895eb77889152f",
        "type": "inject",
        "z": "8c7b432ddeb3c22a",
        "name": "select * from ticker_details",
        "props": [
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "select * from ticker_details ",
        "x": 250,
        "y": 200,
        "wires": [
            [
                "8f7636aa3186befc"
            ]
        ]
    },
    {
        "id": "efee0db7519ce236",
        "type": "function",
        "z": "8c7b432ddeb3c22a",
        "name": "insert into tickers",
        "func": "let ticker = msg.payload[\"ticker\"]\nlet name = msg.payload[\"name\"]\nlet market = msg.payload[\"market\"]\nlet locale = msg.payload[\"locale\"]\nlet primary_exchange = msg.payload[\"primary_exchange\"]\nlet type = msg.payload[\"type\"]\nlet active = msg.payload[\"active\"]\nlet currency_name = msg.payload[\"currency_name\"]\nlet cik = msg.payload[\"cik\"]\nlet composite_figi = msg.payload[\"composite_figi\"]\nlet share_class_figi = msg.payload[\"share_class_figi\"]\nlet market_cap = msg.payload[\"market_cap\"]\nlet phone_number = msg.payload[\"phone_number\"]\nlet address1 = msg.payload[\"address1\"]\naddress1 = ''\nlet description = msg.payload[\"description\"]\ndescription = ''\nlet sic_code = msg.payload[\"sic_code\"]\nlet sic_description = msg.payload[\"sic_description\"]\nlet ticker_root = msg.payload[\"ticker_root\"]\nlet homepage_url = msg.payload[\"homepage_url\"]\nlet total_employees = msg.payload[\"total_employees\"]\nlet list_date = msg.payload[\"list_date\"]\nlet branding = msg.payload[\"branding\"]\nlet share_class_shares_outstanding = msg.payload[\"share_class_shares_outstanding\"]\nlet weighted_shares_outstanding = msg.payload[\"weighted_shares_outstanding\"]\nlet round_lot = msg.payload[\"round_lot\"]\nlet beta = msg.payload[\"beta\"]\nlet current_price = msg.payload[\"current_price\"]\nlet stddev = msg.payload[\"stddev\"]\n\nif (beta == null){ beta - 0}\nif (current_price == null) { current_price = 0 }\nif (stddev == null) { stddev = 0 }\nif (share_class_shares_outstanding == null) { share_class_shares_outstanding = 0 }\nif (weighted_shares_outstanding == null) { weighted_shares_outstanding = 0 }\nif (round_lot == null) { round_lot = 0 }\nif (total_employees == null) { total_employees = 0 }\n\n\nlet sql = \"insert into tickers_detail (ticker, name, market, locale, primary_exchange, type, active, currency_name, cik, composite_figi, share_class_figi, market_cap, phone_number, address1, description, sic_code, sic_description, ticker_root, homepage_url, total_employees, list_date, branding, share_class_shares_outstanding, weighted_shares_outstanding, round_lot, beta, current_price, stddev) values \"\nsql += \"('\" + ticker + \"','\" + name + \"','\" + market + \"','\" + locale + \"','\" + primary_exchange + \"','\" + type + \"','\" + active + \"','\" + currency_name + \"','\" + cik + \"','\" + composite_figi + \"','\" + share_class_figi + \"','\" + market_cap + \"','\" + phone_number + \"','\" + address1 + \"','\" + description + \"','\" + sic_code + \"','\" + sic_description + \"','\" + ticker_root + \"','\" + homepage_url + \"','\" + total_employees + \"','\" + list_date + \"','\" + branding + \"','\" + share_class_shares_outstanding + \"','\" + weighted_shares_outstanding + \"','\" + round_lot + \"','\" + beta + \"','\" + current_price + \"','\" + stddev + \"') ON CONFLICT DO NOTHING;\"\n//node.warn(sql)\nmsg.query = sql\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 710,
        "y": 200,
        "wires": [
            [
                "2d95f50a725dd283"
            ]
        ]
    },
    {
        "id": "95c7564bd6f21f23",
        "type": "split",
        "z": "8c7b432ddeb3c22a",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 550,
        "y": 200,
        "wires": [
            [
                "efee0db7519ce236"
            ]
        ]
    },
    {
        "id": "2d95f50a725dd283",
        "type": "postgresql",
        "z": "8c7b432ddeb3c22a",
        "name": "postgres",
        "query": "",
        "postgreSQLConfig": "7455395cf269fb2b",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 880,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "092a94ec99965947",
        "type": "debug",
        "z": "8c7b432ddeb3c22a",
        "name": "debug 338",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 470,
        "y": 80,
        "wires": []
    },
    {
        "id": "7455395cf269fb2b",
        "type": "postgreSQLConfig",
        "name": "",
        "host": "127.0.0.1",
        "hostFieldType": "str",
        "port": "5432",
        "portFieldType": "num",
        "database": "postgres",
        "databaseFieldType": "str",
        "ssl": "false",
        "sslFieldType": "bool",
        "applicationName": "",
        "applicationNameType": "str",
        "max": "10",
        "maxFieldType": "num",
        "idle": "1000",
        "idleFieldType": "num",
        "connectionTimeout": "10000",
        "connectionTimeoutFieldType": "num",
        "user": "docker",
        "userFieldType": "str",
        "password": "docker",
        "passwordFieldType": "str"
    },
    {
        "id": "3564bcf07c743fdf",
        "type": "MySQLdatabase",
        "name": "ptsapi",
        "host": "ptsapi.cax8fspskl8t.us-east-1.rds.amazonaws.com",
        "port": "3306",
        "db": "ptsapi",
        "tz": "EST5EDT",
        "charset": "UTF8"
    }
]